# üè≠ Shield AI v2.0 - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

## Clean Architecture –ø—Ä–∏–Ω—Ü–∏–ø—ã

Shield AI –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ **Clean Architecture** - –ø–æ–ª–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–ª–æ—ë–≤ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

```
src/shield_ai/
‚îú‚îÄ‚îÄ domain/              # üéØ –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (–Ω–µ–∑–∞–≤–∏—Å–∏–º–∞—è)
‚îÇ   ‚îú‚îÄ‚îÄ entities/        # –î–æ–º–µ–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ product.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ batch.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ shrinkage_profile.py
‚îÇ   ‚îú‚îÄ‚îÄ repositories/    # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ shrinkage/       # –ú–æ–¥–µ–ª–∏ —É—Å—É—à–∫–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ strategies.py  # 3 —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ validation/      # –í–∞–ª–∏–¥–∞—Ü–∏—è
‚îú‚îÄ‚îÄ application/         # üìã Use Cases
‚îÇ   ‚îî‚îÄ‚îÄ use_cases/
‚îÇ       ‚îú‚îÄ‚îÄ calibrate_coefficients.py
‚îÇ       ‚îî‚îÄ‚îÄ forecast_shrinkage.py
‚îú‚îÄ‚îÄ infrastructure/      # üîß –í–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ database/        # SQLAlchemy 2.0
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py     # ORM –º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ session.py
‚îÇ   ‚îú‚îÄ‚îÄ excel/          # Excel –ø–∞—Ä—Å–µ—Ä—ã
‚îÇ   ‚îî‚îÄ‚îÄ config/         # DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
‚îî‚îÄ‚îÄ presentation/        # üñ•Ô∏è UI/API
    ‚îî‚îÄ‚îÄ ui/
        ‚îî‚îÄ‚îÄ pages/       # Streamlit —Å—Ç—Ä–∞–Ω–∏—Ü—ã
```

---

## –°–ª–æ–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### 1. Domain Layer (–î–æ–º–µ–Ω–Ω—ã–π —Å–ª–æ–π)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ß–∏—Å—Ç–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–°–æ–¥–µ—Ä–∂–∏—Ç**:
- `entities/` - –î–æ–º–µ–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ (Product, Batch, ShrinkageProfile)
- `shrinkage/` - –ú–æ–¥–µ–ª–∏ —É—Å—É—à–∫–∏ (3 —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏)
- `repositories/` - –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
- `validation/` - –í–∞–ª–∏–¥–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª

**–ü—Ä–∏–Ω—Ü–∏–ø—ã**:
- –ù–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤
- –ù–µ –∑–Ω–∞–µ—Ç –æ –ë–î, UI, API
- –¢–æ–ª—å–∫–æ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

### 2. Application Layer (–°–ª–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (Use Cases)

**–°–æ–¥–µ—Ä–∂–∏—Ç**:
- `use_cases/` - –ë–∏–∑–Ω–µ—Å-—Å—Ü–µ–Ω–∞—Ä–∏–∏
  - `CalibrateCoefficientsUseCase` - –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞
  - `ForecastShrinkageUseCase` - –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ
- `dto/` - Data Transfer Objects

**–ü—Ä–∏–Ω—Ü–∏–ø—ã**:
- –ó–∞–≤–∏—Å–∏—Ç —Ç–æ–ª—å–∫–æ –æ—Ç Domain
- –û—Ä–∫–µ—Å—Ç—Ä–∏—Ä—É–µ—Ç –¥–æ–º–µ–Ω–Ω—É—é –ª–æ–≥–∏–∫—É

### 3. Infrastructure Layer (–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π —Å–ª–æ–π)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–°–æ–¥–µ—Ä–∂–∏—Ç**:
- `database/` - SQLAlchemy 2.0 ORM
- `excel/` - –ü–∞—Ä—Å–µ—Ä—ã Excel
- `config/` - DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

**–ü—Ä–∏–Ω—Ü–∏–ø—ã**:
- –†–µ–∞–ª–∏–∑—É–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –∏–∑ Domain
- –†–∞–±–æ—Ç–∞–µ—Ç —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

### 4. Presentation Layer (–°–ª–æ–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: UI –∏ API

**–°–æ–¥–µ—Ä–∂–∏—Ç**:
- `ui/pages/` - Streamlit —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- `api/` - FastAPI endpoints (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–ü—Ä–∏–Ω—Ü–∏–ø—ã**:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Use Cases
- –ù–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É

---

## –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

### 1. Dependency Inversion

–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã **–≤–Ω—É—Ç—Ä—å** (–æ—Ç –≤–Ω–µ—à–Ω–∏—Ö —Å–ª–æ—ë–≤ –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º):

```
Presentation ‚Üí Application ‚Üí Domain ‚Üê Infrastructure
```

### 2. SOLID –ø—Ä–∏–Ω—Ü–∏–ø—ã

- **S**ingle Responsibility - –æ–¥–Ω–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å
- **O**pen/Closed - –æ—Ç–∫—Ä—ã—Ç–æ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
- **L**iskov Substitution - –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞—Å–ª–µ–¥–Ω–∏–∫–æ–≤
- **I**nterface Segregation - —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
- **D**ependency Inversion - –∏–Ω–≤–µ—Ä—Å–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### 3. Strategy Pattern

–¢—Ä–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —É—Å—É—à–∫–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ Strategy Pattern.

---

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

### SQLAlchemy 2.0 (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π)

- `Mapped` —Ç–∏–ø–∏–∑–∞—Ü–∏—è
- `mapped_column` –¥–ª—è –∫–æ–ª–æ–Ω–æ–∫
- `relationship` –¥–ª—è —Å–≤—è–∑–µ–π
- `future=True` –¥–ª—è SQLAlchemy 2.0 —Å—Ç–∏–ª—è

### MyPy Strict Mode

- –°—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è
- `py.typed` –º–∞—Ä–∫–µ—Ä
- Type hints –≤–µ–∑–¥–µ

---

**üõ°Ô∏è Shield AI v2.0** - production-ready –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
