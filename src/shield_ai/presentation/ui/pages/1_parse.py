"""
Streamlit —Å—Ç—Ä–∞–Ω–∏—Ü–∞: –ü–∞—Ä—Å–∏–Ω–≥ Excel
"""

import streamlit as st
import pandas as pd

st.header("üìÅ –ü–∞—Ä—Å–∏–Ω–≥ Excel-–æ—Ç—á—ë—Ç–æ–≤ –∏–∑ 1C")

st.info(
    """
**–®–∞–≥ 1**: –ó–∞–≥—Ä—É–∑–∏ Excel —Ñ–∞–π–ª —Å –ø–∞—Ä—Ç–∏—è–º–∏ —Ç–æ–≤–∞—Ä–æ–≤.
–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç —Ñ–∞–π–ª –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –≤ –ë–î.
"""
)

# –ó–∞–≥–æ–ª–æ–≤–æ–∫ "Excel Upload"
st.subheader("Excel Upload")

uploaded_file = st.file_uploader("–í—ã–±–µ—Ä–∏ Excel —Ñ–∞–π–ª", type=["xlsx", "xls"])

if uploaded_file:
    try:
        # –ß—Ç–µ–Ω–∏–µ Excel —Ñ–∞–π–ª–∞
        df = pd.read_excel(uploaded_file)
        
        st.success(f"‚úÖ –§–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω: {uploaded_file.name}")
        
        # –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–µ—Ä–≤—ã—Ö –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å—Ç—Ä–æ–∫ –¥–∞–Ω–Ω—ã—Ö
        st.write(f"**–ü—Ä–æ—Å–º–æ—Ç—Ä –ø–µ—Ä–≤—ã—Ö {min(5, len(df))} —Å—Ç—Ä–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**")
        st.dataframe(df.head())
        
        # –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ñ–∞–π–ª–µ
        st.write(f"**–†–∞–∑–º–µ—Ä—ã —Ñ–∞–π–ª–∞:** {df.shape[0]} —Å—Ç—Ä–æ–∫ x {df.shape[1]} —Å—Ç–æ–ª–±—Ü–æ–≤")
        st.write(f"**–ù–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤:** {', '.join(df.columns.tolist())}")

        if st.button("üöÄ –ó–ê–ì–†–£–ó–ò–¢–¨ –ò –†–ê–°–ü–ê–†–°–ò–¢–¨", type="primary"):
            with st.spinner("–ü–∞—Ä—Å–∏–Ω–≥ —Ñ–∞–π–ª–∞..."):
                st.info("üõ†Ô∏è –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø–∞—Ä—Å–∏–Ω–≥–∞ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ä–µ–ª–∏–∑–µ")
    except Exception as e:
        st.error(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ñ–∞–π–ª–∞: {str(e)}")
else:
    st.warning("‚ö†Ô∏è –ó–∞–≥—Ä—É–∑–∏ Excel —Ñ–∞–π–ª –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã")
