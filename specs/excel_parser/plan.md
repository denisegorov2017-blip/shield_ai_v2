# Технический план: Модуль парсера Excel-отчётов (v2)

**Цель:** Интегрировать предоставленный production-ready код парсера `InventoryParser` в проект в соответствии со `spec.md`.

## 1. Подготовительные шаги

- **[ ] Задача 1.1:** Создать директорию для нового модуля: `src/shield_ai/infrastructure/parsers/`.
- **[ ] Задача 1.2:** Создать файл модуля `src/shield_ai/infrastructure/parsers/inventory_parser.py` и поместить в него предоставленный код.
- **[ ] Задача 1.3:** Убедиться, что зависимости `pandas` и `openpyxl` добавлены в `requirements.txt`.

## 2. Адаптация и интеграция

- **[ ] Задача 2.1:** Адаптировать пути к файлам в коде. В частности, путь к справочнику групп (`data/knowledge/`) и тестовому файлу (`data/input/test_file/`). Создать эти директории и, возможно, пустые файлы-заглушки, если реальных данных нет.
- **[ ] Задача 2.2:** Проверить и при необходимости скорректировать импорты и пространства имен, чтобы код соответствовал структуре проекта `shield_ai`.
- **[ ] Задача 2.3:** Интегрировать логгер. Код уже предусматривает использование `logging`, необходимо убедиться, что он будет работать с основной конфигурацией логирования проекта.

## 3. Финализация

- **[ ] Задача 3.1:** Проверить, что весь код соответствует `spec.md`, включая наличие docstring'ов, типизации и общую структуру. (На первый взгляд, предоставленный код уже соответствует).
- **[ ] Задача 3.2:** Удалить или закомментировать блок `if __name__ == '__main__':`, так как он предназначен для демонстрации, а не для использования в качестве модуля.

## 4. Схема выполнения

```mermaid
graph TD
    A[Старт] --> B{Подготовка};
    B --> B1[Создать директорию parsers];
    B1 --> B2[Создать файл inventory_parser.py с кодом];
    B2 --> B3[Проверить requirements.txt];
    B3 --> C{Интеграция};
    C --> C1[Адаптировать пути к файлам];
    C1 --> C2[Скорректировать импорты];
    C2 --> C3[Настроить логирование];
    C3 --> D{Финализация};
    D --> D1[Финальная проверка по spec.md];
    D1 --> D2[Обработать блок main];
    D2 --> E[Финиш];