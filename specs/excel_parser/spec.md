# Спецификация: Модуль парсера Excel-отчётов (InventoryParser)

## 1. Обзор

**Задача:** Разработать production-ready модуль на Python для парсинга стандартизированных Excel-отчётов о движении товаров.

**Цель:** Предоставить надёжный, документированный и тестируемый инструмент для извлечения, валидации и структурирования данных из `.xlsx` файлов.

## 2. Функциональные требования

### 2.1. Класс `InventoryParser`
- **Класс:** `InventoryParser`
- **Назначение:** Основной класс для инкапсуляции логики парсинга.
- **Инициализация:** Принимает на вход путь к Excel-файлу.
- **Публичный метод `parse()`:**
  - Запускает процесс чтения и обработки файла.
  - Возвращает список объектов (например, dataclass или `dict`), представляющих строки отчёта.
  - В случае ошибки (неверный формат, отсутствующие колонки) должен выбрасывать кастомные исключения (`InvalidFormatError`, `MissingColumnsError`).

### 2.2. Структура входного файла
- **Формат:** `.xlsx`
- **Лист:** Данные всегда находятся на первом листе (`index=0`).
- **Ожидаемые колонки (обязательные):**
  - `product_id`: ID товара (строка)
  - `product_name`: Наименование товара (строка)
  - `quantity`: Количество (целое число)
  - `movement_type`: Тип движения (строка, 'приход'/'расход')
  - `date`: Дата операции (дата/время)

### 2.3. Обработка данных
- Пропускать пустые строки.
- Валидировать типы данных в колонках.
- Приводить `movement_type` к нижнему регистру.

## 3. Нефункциональные требования

### 3.1. Качество кода
- **Документация:**
  - Подробный docstring для класса `InventoryParser` и его публичных методов в формате ReST.
  - Комментарии в коде для сложных участков логики.
- **Типизация:** Строгая типизация с использованием `typing`.
- **Стиль кода:** Соответствие стандарту PEP 8.

### 3.2. Зависимости
- Использовать библиотеку `pandas` или `openpyxl` для работы с Excel. Зависимость должна быть добавлена в `requirements.txt`.

### 3.3. Тестирование
- Модуль должен сопровождаться unit-тестами (не в рамках этой задачи, но архитектура должна это позволять).

## 4. Пример использования

В документации к классу должен быть приведён ясный пример его использования:

```python
from inventory_parser import InventoryParser, InvalidFormatError

try:
    parser = InventoryParser(path_to_file='report.xlsx')
    data = parser.parse()
    for item in data:
        print(item)
except (FileNotFoundError, InvalidFormatError) as e:
    print(f"Ошибка обработки отчёта: {e}")

```

## 5. Критерии приёмки
- Создан файл `src/shield_ai/infrastructure/parsers/inventory_parser.py` с классом `InventoryParser`.
- Класс и его методы полностью документированы.
- Реализована вся логика, описанная в функциональных требованиях.
- Зависимость добавлена в `requirements.txt`.
- Код соответствует стандартам качества.